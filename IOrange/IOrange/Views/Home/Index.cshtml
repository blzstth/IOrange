@model IEnumerable<IOrange.ViewModels.ItemViewModel>

<!DOCTYPE html>
<html>
<head>
    <title>Main Page</title>
    <link rel="stylesheet" href="~/css/HomePage.css" />
</head>
<body>

    <table id="table1">
        <thead>
            <tr>
                <th>Items</th>
            </tr>
        </thead>
        <tbody id="itemsS">
        
        </tbody>
        <tfoot>
            <tr>
                <td id="total">Total: 0 Ft</td>
                <td id="deleteS"><button>Delete last item</button></td>
                <td id="submitTd"><button>Submit</button></td>
            </tr>
        </tfoot>
    </table>

    <table id="table2">
        <tr>
            <th id="currentTime"></th>
            <th>@ViewBag.Username</th>
        </tr>
        @{
            int rows = 0;
        }
        @foreach (var item in Model)
        {
            if (rows % 12 == 0)
            {
                <tr>
                    <td><button class="termekek" data-name="@item.Name" data-price="@item.Price">@item.Name @item.Price Ft</button></td>
                </tr>
            }
            else
            {
                <td><button class="termekek" data-name="@item.Name" data-price="@item.Price">@item.Name @item.Price Ft</button></td>
            }
            rows++;
        }
    </table>

    <script>
        
        let selectedItems = [];
        let totalAct = 0;  

        
        document.querySelectorAll('.termekek').forEach(button => {
            button.addEventListener('click', function () {
                
                const itemName = this.getAttribute('data-name');
                const itemPrice = this.getAttribute('data-price');

                
                selectedItems.push({ name: itemName, price: parseFloat(itemPrice) });

                
                appendToTable1(itemName, itemPrice);
            });
        });

        
        function appendToTable1(itemName, itemPrice) {
            const itemsTableBody = document.getElementById('itemsS');
            const total = document.getElementById('total');

          
            const itemRow = document.createElement('tr');
            const itemCell = document.createElement('td');
            itemCell.textContent = `${itemName} - ${itemPrice} Ft`;

            
            itemRow.appendChild(itemCell);
            itemsTableBody.appendChild(itemRow);

            
            totalAct += parseFloat(itemPrice);
            total.textContent = `Total: ${totalAct} Ft`;  
        }

        
        document.getElementById('deleteS').addEventListener('click', function () {
            if (selectedItems.length > 0) {
                const removedItem = selectedItems.pop(); 
                totalAct -= removedItem.price;          

              
                refreshTable1();
            }
        });

        
        function refreshTable1() {
            const itemsTableBody = document.getElementById('itemsS');
            const total = document.getElementById('total');

            
            itemsTableBody.innerHTML = '';
            totalAct = 0;  

            
            selectedItems.forEach(item => {
                const itemRow = document.createElement('tr');
                const itemCell = document.createElement('td');
                itemCell.textContent = `${item.name} - ${item.price} Ft`;
                itemRow.appendChild(itemCell);
                itemsTableBody.appendChild(itemRow);

                
                totalAct += parseFloat(item.price);
            });

            
            total.textContent = `Total: ${totalAct} Ft`;
        }

        
        function updateTime() {
            const timeCell = document.getElementById('currentTime');
            const now = new Date();

            
            const date = now.toLocaleDateString();
           
            const time = now.toLocaleTimeString();

            
            timeCell.textContent = `${date} ${time}`;
        }

        
        setInterval(updateTime, 1000);

        
        document.getElementById('submitTd').addEventListener('click', function () {
            alert('Submit clicked with ' + selectedItems.length + ' items selected!');

        });
    </script>

</body>
</html>
